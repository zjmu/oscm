<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="edu.jmu.oscm.mapper.ReduceTargetMapper">

    <resultMap id = "reduceTargetMapper" type="edu.jmu.oscm.model.ReduceTarget">
        <id column="id" property="id"/>
        <result column="REPORT_ITEM_ID" property="report_item_id"/>
        <result column="year" property="year"/>
        <result column="year_percent" property="year_percent"/>
        <result column="year_value" property="year_value"/>
        <result column="last_year_value" property="last_year_value"/>
        <result column="jan" property="jan"/>
        <result column="feb" property="feb"/>
        <result column="mar" property="mar"/>
        <result column="apr" property="apr"/>
        <result column="may" property="may"/>
        <result column="jun" property="jun"/>
        <result column="jul" property="jul"/>
        <result column="aug" property="aug"/>
        <result column="sept" property="sept"/>
        <result column="oct" property="oct"/>
        <result column="nov" property="nov"/>
        <result column="dec" property="dec"/>
        <result column="asset_or_debt" property="asset_or_debt"/>
        <result column="create_date" property="create_date"/>
    </resultMap>

   <insert id="add" parameterType="edu.jmu.oscm.model.ReduceTarget" useGeneratedKeys="true" keyProperty="id">
        INSERT INTO ad_item_reduce_target (REPORT_ITEM_ID, `year`, year_percent, year_value, last_year_value, jan, feb, mar, apr, may, jun, jul, aug, sept, oct, nov, `dec`, asset_or_debt, create_date)
        VALUE (#{report_item_id}, #{year}, #{year_percent}, #{year_value}, #{last_year_value}, #{jan},#{feb}, #{mar}, #{apr}, #{may}, #{jun},#{jul}, #{aug}, #{sept}, #{oct}, #{nov}, #{dec}, #{asset_or_debt}, #{create_date})
    </insert>

    <update id="update" parameterType="edu.jmu.oscm.model.ReduceTarget">
        UPDATE ad_item_reduce_target
        SET year_value = #{year_value}, jan = #{jan}, feb = #{feb}, mar = #{mar}, apr = #{apr}, may = #{may}, jun = #{jun}, jul = #{jul}, aug = #{aug}, sept = #{sept}, oct = #{oct}, nov = #{nov}, `dec` = #{dec}
        WHERE id = #{id}
    </update>

    <update id="updates" parameterType="java.util.List">
        UPDATE ad_item_reduce_target
        <trim prefix="set" suffixOverrides=",">
            <trim prefix="year_value = case" suffix="end,">
                <foreach collection="list" item="reduceTarget">
                    WHEN id = #{reduceTarget.id} THEN #{reduceTarget.year_value}
                </foreach>
            </trim>
            <trim prefix="jan = case" suffix="end,">
                <foreach collection="list" item="reduceTarget">
                    WHEN id = #{reduceTarget.id} THEN #{reduceTarget.jan}
                </foreach>
            </trim>
            <trim prefix="feb = case" suffix="end,">
                <foreach collection="list" item="reduceTarget">
                    WHEN id = #{reduceTarget.id} THEN #{reduceTarget.feb}
                </foreach>
            </trim>
            <trim prefix="mar = case" suffix="end,">
                <foreach collection="list" item="reduceTarget">
                    WHEN id = #{reduceTarget.id} THEN #{reduceTarget.mar}
                </foreach>
            </trim>
            <trim prefix="apr = case" suffix="end,">
                <foreach collection="list" item="reduceTarget">
                    WHEN id = #{reduceTarget.id} THEN #{reduceTarget.apr}
                </foreach>
            </trim>
            <trim prefix="may = case" suffix="end,">
                <foreach collection="list" item="reduceTarget">
                    WHEN id = #{reduceTarget.id} THEN #{reduceTarget.may}
                </foreach>
            </trim>
            <trim prefix="jun = case" suffix="end,">
                <foreach collection="list" item="reduceTarget">
                    WHEN id = #{reduceTarget.id} THEN #{reduceTarget.jun}
                </foreach>
            </trim>
            <trim prefix="jul = case" suffix="end,">
                <foreach collection="list" item="reduceTarget">
                    WHEN id = #{reduceTarget.id} THEN #{reduceTarget.jul}
                </foreach>
            </trim>
            <trim prefix="aug = case" suffix="end,">
                <foreach collection="list" item="reduceTarget">
                    WHEN id = #{reduceTarget.id} THEN #{reduceTarget.aug}
                </foreach>
            </trim>
            <trim prefix="sept = case" suffix="end,">
                <foreach collection="list" item="reduceTarget">
                    WHEN id = #{reduceTarget.id} THEN #{reduceTarget.sept}
                </foreach>
            </trim>
            <trim prefix="oct = case" suffix="end,">
                <foreach collection="list" item="reduceTarget">
                    WHEN id = #{reduceTarget.id} THEN #{reduceTarget.oct}
                </foreach>
            </trim>
            <trim prefix="nov = case" suffix="end,">
                <foreach collection="list" item="reduceTarget">
                    WHEN id = #{reduceTarget.id} THEN #{reduceTarget.nov}
                </foreach>
            </trim>
            <trim prefix="`dec` = case" suffix="end,">
                <foreach collection="list" item="reduceTarget">
                    WHEN id = #{reduceTarget.id} THEN #{reduceTarget.dec}
                </foreach>
            </trim>
        </trim>
        <where>
            <foreach collection="list" item="reduceTarget" separator="or">
                id = #{reduceTarget.id}
            </foreach>
        </where>
    </update>

    <delete id="deleteByID" parameterType="integer" >
        DELETE FROM ad_item_reduce_target
        WHERE id = #{id}
    </delete>
    <delete id="deleteAll">
        DELETE
        FROM ad_item_reduce_target
        WHERE 1 = 1
    </delete>
    <select id="queryAll" resultType="edu.jmu.oscm.model.ReduceTarget">
        SELECT *
        from ad_item_reduce_target
    </select>
    <select id="queryByID" resultType="edu.jmu.oscm.model.ReduceTarget" parameterType="integer">
        SELECT *
        FROM ad_item_reduce_target
        WHERE id = #{id}
    </select>


<!--    使用了druid数据源，则配置的时候要注意：
    不能配置wall拦截器，否则批量更新不成功。
    url: jdbc:mysql://127.0.0.1:3306/aderi?useUnicode=true&characterEncoding=UTF-8&allowMultiQueries=true
    <update id="updates" parameterType="java.util.List">
        <foreach collection = "list" item="reduceTarget" separator=";">
            UPDATE ad_item_reduce_target
            SET year_value = #{reduceTarget.year_value}, jan = #{reduceTarget.jan}, feb = #{reduceTarget.feb}, mar = #{reduceTarget.mar}, apr = #{reduceTarget.apr}, may = #{reduceTarget.may}, jun = #{reduceTarget.jun}, jul = #{reduceTarget.jul}, aug = #{reduceTarget.aug}, sept = #{reduceTarget.sept}, oct = #{reduceTarget.oct}, nov = #{reduceTarget.nov}, `dec` = #{reduceTarget.dec}
            WHERE id = #{reduceTarget.id}
        </foreach>
    </update>-->

</mapper>